# test-srvn

## Задачи

### Задача 1 (SQL): Исследование данных E-commerce
**Задача:** Сформировать таблицу сессий пользователей из таблицы событий.

**Сессия** – набор последовательных событий по одному пользователю.

Событие считается первым в сессии (начало новой сессии) если (или):

1. Это событие - session_start
2. Предыдущие событие - session_end
3. От предыдущего события прошло более 30 минут
4. Наступил новый календарный день
5. Это первое событие пользователя за все время

Необходимо написать SQL-запрос, который создаст таблицу сессий пользователей.

Таблица должна состоять из следующих полей:
1. `SESSION_ID` – уникальный идентификатор сессии
2. `SESSION_START_DTM` – дата и время начала сессии
3. `SESSION_END_DTM` – дата и время конца сессии
4. `USER_ID` – идентификатор пользователя
5. `SESSION_NUMBER` – порядковый номер сессии для данного пользователя
6. `IS_CLIENT` – поле, которое обозначает, является ли пользователь клиентом *(пользователь является клиентом, если за всю историю у него было хотя бы одно событие purchase, не важно в рамках текущей сессии или нет)*


### Задача 2 (SQL): Исследование данных Retail
Имеется доступ к данным компании с информацией о продажах товаров, пользователях компании, ассортименте продуктов, а также о магазинах сети.

Необходимо создать таблицу агрегированную по пользователям и  выкупленными заказами (в каждом заказе должны быть только выкупленные товары).

* `USER_ID` - идентификатор пользователя
* `ORDER_ID` - идентификатор заказа
* `RDER_DATE` - дата создания заказа
* `ORDER_SUM` - сумма заказа
* `ORDER_REVENUE` - выручка с заказа
* `ORDER_QUANTITY` - суммарное кол-во товаров в заказе
* `ORDER_UNIQUE_PRODUCTS` - кол-во уникальных товаров в заказе (по product_id)


### Задача 3 (Python/R): Подготовка к встрече с новым владельцем сети магазинов
3.1. Подготовить информацию для встречи, где были бы собраны ключевые метрики, графики и сегменты для новых владельцев бизнеса. 

3.2 Определить сколько единиц каждого товара необходимо поставить в каждый из магазинов в следующем месяце. Целью является совершить одну поставку товара в начале месяца и не довозить его больше, до начала следующего.

# Stack
- sql
- python
  - pandas
  - numpy
  - pandasql
  - gdown
  - seaborn
  - matplotlib
  - orbit
